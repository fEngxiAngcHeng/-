layui.define("jquery",function(t){var e=layui.jquery,n=layui.jquery;!function(t){t.Jcrop=function(e,n){function o(t){return""+parseInt(t)+"px"}function a(t){return""+parseInt(t)+"%"}function s(t){return j.baseClass+"-"+t}function r(e){var i=t(e).offset();return[i.left,i.top]}function l(t){return[t.pageX-ot[0],t.pageY-ot[1]]}function d(t){t!=G&&(rt.setCursor(t),G=t)}function u(t,e){if(ot=r(U),rt.setCursor("move"==t?t:t+"-resize"),"move"==t)return rt.activateHandlers(p(e),b);var i=at.getFixed(),n=f(t),o=at.getCorner(f(n));at.setPressed(at.getCorner(n)),at.setCurrent(o),rt.activateHandlers(c(t,i),b)}function c(t,e){return function(i){if(j.aspectRatio)switch(t){case"e":i[1]=e.y+1;break;case"w":i[1]=e.y+1;break;case"n":i[0]=e.x+1;break;case"s":i[0]=e.x+1}else switch(t){case"e":i[1]=e.y2;break;case"w":i[1]=e.y2;break;case"n":i[0]=e.x2;break;case"s":i[0]=e.x2}at.setCurrent(i),st.update()}}function p(t){var e=t;return lt.watchKeys(),function(t){at.moveOffset([t[0]-e[0],t[1]-e[1]]),e=t,st.update()}}function f(t){switch(t){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function v(t){return function(e){return!j.disabled&&(!("move"==t&&!j.allowMove)&&(q=!0,u(t,l(e)),e.stopPropagation(),e.preventDefault(),!1))}}function g(t,e,i){var n=t.width(),o=t.height();n>e&&e>0&&(n=e,o=e/t.width()*t.height()),o>i&&i>0&&(o=i,n=i/t.height()*t.width()),Y=t.width()/n,K=t.height()/o,t.width(n).height(o)}function m(t){return{x:parseInt(t.x*Y),y:parseInt(t.y*K),x2:parseInt(t.x2*Y),y2:parseInt(t.y2*K),w:parseInt(t.w*Y),h:parseInt(t.h*K)}}function b(t){var e=at.getFixed();e.w>j.minSelect[0]&&e.h>j.minSelect[1]?(st.enableHandles(),st.done()):st.release(),rt.setCursor(j.allowSelect?"crosshair":"default")}function x(t){if(j.disabled)return!1;if(!j.allowSelect)return!1;q=!0,ot=r(U),st.disableHandles(),d("crosshair");var e=l(t);return at.setPressed(e),rt.activateHandlers(y,b),lt.watchKeys(),st.update(),t.stopPropagation(),t.preventDefault(),!1}function y(t){at.setCurrent(t),st.update()}function _(){var e=t("<div></div>").addClass(s("tracker"));return t.browser.msie&&e.css({opacity:0,backgroundColor:"white"}),e}function F(t){function e(){window.setTimeout(w,d)}var i=t[0]/Y,n=t[1]/K,o=t[2]/Y,a=t[3]/K;if(!V){var s=at.flipCoords(i,n,o,a),r=at.getFixed(),l=initcr=[r.x,r.y,r.x2,r.y2],d=j.animationDelay,u=l[0],c=l[1],o=l[2],a=l[3],p=s[0]-initcr[0],f=s[1]-initcr[1],h=s[2]-initcr[2],v=s[3]-initcr[3],g=0,m=j.swingSpeed;st.animMode(!0);var w=function(){return function(){g+=(100-g)/m,l[0]=u+g/100*p,l[1]=c+g/100*f,l[2]=o+g/100*h,l[3]=a+g/100*v,g<100?e():st.done(),g>=99.8&&(g=100),I(l)}}();e()}}function S(t){I([t[0]/Y,t[1]/K,t[2]/Y,t[3]/K])}function I(t){at.setPressed([t[0],t[1]]),at.setCurrent([t[2],t[3]]),st.update()}function z(e){"object"!=typeof e&&(e={}),j=t.extend(j,e),"function"!=typeof j.onChange&&(j.onChange=function(){}),"function"!=typeof j.onSelect&&(j.onSelect=function(){})}function C(){return m(at.getFixed())}function k(){return at.getFixed()}function D(t){z(t),O()}function P(){j.disabled=!0,st.disableHandles(),st.setCursor("default"),rt.setCursor("default")}function H(){j.disabled=!1,O()}function M(){st.done(),rt.activateHandlers(null,null)}function T(){B.remove(),E.show()}function O(t){j.allowResize?t?st.enableOnly():st.enableHandles():st.disableHandles(),rt.setCursor(j.allowSelect?"crosshair":"default"),st.setCursor(j.allowMove?"move":"default"),B.css("backgroundColor",j.bgColor),"setSelect"in j&&(S(n.setSelect),st.done(),delete j.setSelect),"trueSize"in j&&(Y=j.trueSize[0]/A,K=j.trueSize[1]/R),W=j.maxSize[0]||0,N=j.maxSize[1]||0,X=j.minSize[0]||0,J=j.minSize[1]||0,"outerImage"in j&&(U.attr("src",j.outerImage),delete j.outerImage),st.refresh()}var e=e,n=n;"object"!=typeof e&&(e=t(e)[0]),"object"!=typeof n&&(n={}),"trackDocument"in n||(n.trackDocument=!t.browser.msie,t.browser.msie&&"8"==t.browser.version.split(".")[0]&&(n.trackDocument=!0)),"keySupport"in n||(n.keySupport=!t.browser.msie);var L={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,borderOpacity:.4,handleOpacity:.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}},j=L;z(n);var E=t(e),U=E.clone().removeAttr("id").css({position:"absolute"});U.width(E.width()),U.height(E.height()),E.after(U).hide(),g(U,j.boxWidth,j.boxHeight);var A=U.width(),R=U.height(),B=t("<div />").width(A).height(R).addClass(s("holder")).css({position:"relative",backgroundColor:j.bgColor}).insertAfter(E).append(U);j.addClass&&B.addClass(j.addClass);var W,N,X,J,Y,K,q,G,V,Q,Z=t("<img />").attr("src",U.attr("src")).css("position","absolute").width(A).height(R),$=t("<div />").width(a(100)).height(a(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(Z),tt=t("<div />").width(a(100)).height(a(100)).css("zIndex",320),et=t("<div />").css({position:"absolute",zIndex:300}).insertBefore(U).append($,tt),it=j.boundary,nt=_().width(A+2*it).height(R+2*it).css({position:"absolute",top:o(-it),left:o(-it),zIndex:290}).mousedown(x),ot=r(U),at=function(){function t(t){var t=s(t);v=p=t[0],g=f=t[1]}function e(t){var t=s(t);u=t[0]-v,c=t[1]-g,v=t[0],g=t[1]}function i(){return[u,c]}function n(t){var e=t[0],i=t[1];0>p+e&&(e-=e+p),0>f+i&&(i-=i+f),R<g+i&&(i+=R-(g+i)),A<v+e&&(e+=A-(v+e)),p+=e,v+=e,f+=i,g+=i}function o(t){var e=a();switch(t){case"ne":return[e.x2,e.y];case"nw":return[e.x,e.y];case"se":return[e.x2,e.y2];case"sw":return[e.x,e.y2]}}function a(){if(!j.aspectRatio)return l();var t,e,i=j.aspectRatio,n=j.minSize[0]/Y,o=(j.minSize[1]/K,j.maxSize[0]/Y),a=j.maxSize[1]/K,s=v-p,u=g-f,c=Math.abs(s),m=Math.abs(u),b=c/m;return 0==o&&(o=10*A),0==a&&(a=10*R),b<i?(e=g,w=m*i,t=s<0?p-w:w+p,t<0?(t=0,h=Math.abs((t-p)/i),e=u<0?f-h:h+f):t>A&&(t=A,h=Math.abs((t-p)/i),e=u<0?f-h:h+f)):(t=v,h=c/i,e=u<0?f-h:f+h,e<0?(e=0,w=Math.abs((e-f)*i),t=s<0?p-w:w+p):e>R&&(e=R,w=Math.abs(e-f)*i,t=s<0?p-w:w+p)),t>p?(t-p<n?t=p+n:t-p>o&&(t=p+o),e=e>f?f+(t-p)/i:f-(t-p)/i):t<p&&(p-t<n?t=p-n:p-t>o&&(t=p-o),e=e>f?f+(p-t)/i:f-(p-t)/i),t<0?(p-=t,t=0):t>A&&(p-=t-A,t=A),e<0?(f-=e,e=0):e>R&&(f-=e-R,e=R),last=d(r(p,f,t,e))}function s(t){return t[0]<0&&(t[0]=0),t[1]<0&&(t[1]=0),t[0]>A&&(t[0]=A),t[1]>R&&(t[1]=R),[t[0],t[1]]}function r(t,e,i,n){var o=t,a=i,s=e,r=n;return i<t&&(o=i,a=t),n<e&&(s=n,r=e),[Math.round(o),Math.round(s),Math.round(a),Math.round(r)]}function l(){var t=v-p,e=g-f;if(W&&Math.abs(t)>W&&(v=t>0?p+W:p-W),N&&Math.abs(e)>N&&(g=e>0?f+N:f-N),J&&Math.abs(e)<J&&(g=e>0?f+J:f-J),X&&Math.abs(t)<X&&(v=t>0?p+X:p-X),p<0&&(v-=p,p-=p),f<0&&(g-=f,f-=f),v<0&&(p-=v,v-=v),g<0&&(f-=g,g-=g),v>A){var i=v-A;p-=i,v-=i}if(g>R){var i=g-R;f-=i,g-=i}if(p>A){var i=p-R;g-=i,f-=i}if(f>R){var i=f-R;g-=i,f-=i}return d(r(p,f,v,g))}function d(t){return{x:t[0],y:t[1],x2:t[2],y2:t[3],w:t[2]-t[0],h:t[3]-t[1]}}var u,c,p=0,f=0,v=0,g=0;return{flipCoords:r,setPressed:t,setCurrent:e,getOffset:i,moveOffset:n,getCorner:o,getFixed:a}}(),st=function(){function e(e){var i=t("<div />").css({position:"absolute",opacity:j.borderOpacity}).addClass(s(e));return $.append(i),i}function n(e,i){var n=t("<div />").mousedown(v(e)).css({cursor:e+"-resize",position:"absolute",zIndex:i});return tt.append(n),n}function r(t){return n(t,C++).css({top:o(-H+1),left:o(-H+1),opacity:j.handleOpacity}).addClass(s("handle"))}function l(t){var e=j.handleSize,i=H,s=e,r=e,l=i,d=i;switch(t){case"n":case"s":r=a(100);break;case"e":case"w":s=a(100)}return n(t,C++).width(r).height(s).css({top:o(-l+1),left:o(-d+1)})}function d(t){for(i in t)D[t[i]]=r(t[i])}function u(t){var e=Math.round(t.h/2-H),i=Math.round(t.w/2-H),n=(west=-H+1,t.w-H),a=t.h-H;"e"in D&&D.e.css({top:o(e),left:o(n)})&&D.w.css({top:o(e)})&&D.s.css({top:o(a),left:o(i)})&&D.n.css({left:o(i)}),"ne"in D&&D.ne.css({left:o(n)})&&D.se.css({top:o(a),left:o(n)})&&D.sw.css({top:o(a)}),"b"in D&&D.b.css({top:o(a)})&&D.r.css({left:o(n)})}function c(t,e){Z.css({top:o(-e),left:o(-t)}),et.css({top:o(e),left:o(t)})}function p(t,e){et.width(t).height(e)}function f(){var t=at.getFixed();at.setPressed([t.x,t.y]),at.setCurrent([t.x2,t.y2]),h()}function h(){if(z)return g()}function g(){var t=at.getFixed();p(t.w,t.h),c(t.x,t.y),j.drawBorders&&k.right.css({left:o(t.w-1)})&&k.bottom.css({top:o(t.h-1)}),P&&u(t),z||w(),j.onChange(m(t))}function w(){et.show(),U.css("opacity",j.bgOpacity),z=!0}function b(){F(),et.hide(),U.css("opacity",1),z=!1}function x(){P&&(u(at.getFixed()),tt.show())}function y(){if(P=!0,j.allowResize)return u(at.getFixed()),tt.show(),!0}function F(){P=!1,tt.hide()}function S(t){(V=t)?F():y()}function I(){S(!1),f()}var z,C=370,k={},D={},P=!1,H=j.handleOffset;j.drawBorders&&(k={top:e("hline").css("top",o(t.browser.msie?-1:0)),bottom:e("hline"),left:e("vline"),right:e("vline")}),j.dragEdges&&(D.t=l("n"),D.b=l("s"),D.r=l("e"),D.l=l("w")),j.sideHandles&&d(["n","s","e","w"]),j.cornerHandles&&d(["sw","nw","ne","se"]);var M=_().mousedown(v("move")).css({cursor:"move",position:"absolute",zIndex:360});return $.append(M),F(),{updateVisible:h,update:g,release:b,refresh:f,setCursor:function(t){M.css("cursor",t)},enableHandles:y,enableOnly:function(){P=!0},showHandles:x,disableHandles:F,animMode:S,done:I}}(),rt=function(){function e(){nt.css({zIndex:450}),u&&t(document).mousemove(n).mouseup(o)}function i(){nt.css({zIndex:290}),u&&t(document).unbind("mousemove",n).unbind("mouseup",o)}function n(t){r(l(t))}function o(t){return t.preventDefault(),t.stopPropagation(),q&&(q=!1,d(l(t)),j.onSelect(m(at.getFixed())),i(),r=function(){},d=function(){}),!1}function a(t,i){return q=!0,r=t,d=i,e(),!1}function s(t){nt.css("cursor",t)}var r=function(){},d=function(){},u=j.trackDocument;return u||nt.mousemove(n).mouseup(o).mouseout(o),U.before(nt),{activateHandlers:a,setCursor:s}}(),lt=function(){function e(){j.keySupport&&(a.show(),a.focus())}function i(t){a.hide()}function n(t,e,i){j.allowMove&&(at.moveOffset([e,i]),st.updateVisible()),t.preventDefault(),t.stopPropagation()}function o(t){if(t.ctrlKey)return!0;Q=!!t.shiftKey;var e=Q?10:1;switch(t.keyCode){case 37:n(t,-e,0);break;case 39:n(t,e,0);break;case 38:n(t,0,-e);break;case 40:n(t,0,e);break;case 27:st.release();break;case 9:return!0}return nothing(t)}var a=t('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(o).blur(i),s=t("<div />").css({position:"absolute",overflow:"hidden"}).append(a);return j.keySupport&&s.insertBefore(U),{watchKeys:e}}();tt.hide(),O(!0);var dt={animateTo:F,setSelect:S,setOptions:D,tellSelect:C,tellScaled:k,disable:P,enable:H,cancel:M,focus:lt.watchKeys,getBounds:function(){return[A*Y,R*K]},getWidgetSize:function(){return[A,R]},release:st.release,destroy:T};return E.data("Jcrop",dt),dt},t.fn.Jcrop=function(e){function i(i){var n=e.useImg||i.src,o=new Image;o.onload=function(){t.Jcrop(i,e)},o.src=n}return"object"!=typeof e&&(e={}),this.each(function(){if(t(this).data("Jcrop")){if("api"==e)return t(this).data("Jcrop");t(this).data("Jcrop").setOptions(e)}else i(this)}),this}}(e),function(t,e){t.fn.zyPopup=function(e,i){var n=Array.prototype.slice.call(arguments,1);if("string"==typeof e){var o=this[0][e];if(t.isFunction(o))return o.apply(this,n);throw"zyPopup - No such method: "+e}return this.each(function(){var i={},n="",o="",a=!1,s=null,r="",l="",d={},u={src:"",index:0,name:"",onTailor:function(t){}};i=t.extend(u,e),this.init=function(){this.createHtml(),this.openPopup(),this.bindPopupEvent()},this.createHtml=function(){t("#zoom").remove(),t("body").append('<div id="zoom"><a class="finish"></a><a class="close"></a><div class="content loading"></div></div>'),n=t("#zoom").hide(),o=t("#zoom .content"),a=!1,s=null,r=t(window).width(),l=t(window).height()},this.openPopup=function(){function e(){function e(t){t.show(),o.removeClass("loading"),s.createTailorPlug()}var i=t(this),n=parseInt(o.css("borderLeftWidth")),a=r-2*n,d=l-2*n,u=i.width(),c=i.height();return u==o.width()&&u<=a&&c==o.height()&&c<=d?void e(i):void o.animate({width:i.width(),height:i.height(),marginTop:-(i.height()/2)-n,marginLeft:-(i.width()/2)-n},200,function(){e(i)})}var s=this,d=t(new Image).attr("id","tailorImg").hide();t("#zoom .previous, #zoom .next").show(),a||(a=!0,n.show(),t("body").addClass("zoomed")),o.html(d).delay(500).addClass("loading"),d.load(e).attr("src",i.src)},this.createTailorPlug=function(){function e(t){d={leftX:t.x,leftY:t.y,rightX:t.x2,rightY:t.y2,width:t.w,height:t.h}}var i=t("#tailorImg").width(),n=t("#tailorImg").height(),o=i/2-i/5,a=n/2-n/5,s=i/2+i/5,r=n/2+n/5;t.Jcrop("#tailorImg",{setSelect:[o,a,s,r],onChange:e,onSelect:e})},this.bindPopupEvent=function(){var e=this;n.bind("click",function(i){i.preventDefault(),"zoom"==t(i.target).attr("id")&&e.closePopup(i)}),t("#zoom .finish").bind("click",function(n){var o=new Object;o.width=t(".jcrop-holder>div>div>img").width(),o.height=t(".jcrop-holder>div>div>img").height(),i.onTailor(d,o),e.closePopup(n)}),t("#zoom .close").bind("click",function(t){e.closePopup(t)})},this.closePopup=function(e){e&&e.preventDefault(),a=!1,s=null,n.hide(),t("body").removeClass("zoomed"),o.empty()},this.init()})}}(e);var o={fileInput:null,uploadInput:null,dragDrop:null,url:"",uploadFile:[],lastUploadFile:[],perUploadFile:[],fileNum:0,filterFile:function(t){return t},onSelect:function(t,e){},onDelete:function(t,e){},onProgress:function(t,e,i){},onSuccess:function(t,e){},onFailure:function(t,e){},onComplete:function(t){},funDragHover:function(t){return t.stopPropagation(),t.preventDefault(),this["dragover"===t.type?"onDragOver":"onDragLeave"].call(t.target),this},funGetFiles:function(t){var e=this;this.funDragHover(t);var i=t.target.files||t.dataTransfer.files;e.lastUploadFile=this.uploadFile,this.uploadFile=this.uploadFile.concat(this.filterFile(i));var o=[],a=[],s=[];return n.each(e.lastUploadFile,function(t,e){a.push(e.name)}),n.each(e.uploadFile,function(t,e){s.push(e.name)}),n.each(s,function(t,i){n.inArray(i,a)<0&&o.push(e.uploadFile[t])}),this.uploadFile=o,this.funDealtFiles(),!0},funDealtFiles:function(){var t=this;n.each(this.uploadFile,function(e,i){i.index=t.fileNum,t.fileNum++});var e=this.uploadFile;return this.perUploadFile=this.perUploadFile.concat(this.uploadFile),this.uploadFile=this.lastUploadFile.concat(this.uploadFile),this.onSelect(e,this.uploadFile),console.info("继续选择"),console.info(this.uploadFile),this},funDeleteFile:function(t,e){var i=this,o=[],a=this.perUploadFile[t];return n.each(this.uploadFile,function(t,e){a!=e&&o.push(e)}),this.uploadFile=o,e&&i.onDelete(a,this.uploadFile),console.info("还剩这些文件没有上传:"),console.info(this.uploadFile),!0},funUploadFiles:function(){var t=this;n.each(this.uploadFile,function(e,i){t.funUploadFile(i)})},funUploadFile:function(t){var e=this,i=new FormData;i.append("file",t),n("#uploadTailor_"+t.index).length>0&&i.append("tailor",n("#uploadTailor_"+t.index).attr("tailor"));var o=new XMLHttpRequest;o.upload.addEventListener("progress",function(i){e.onProgress(t,i.loaded,i.total)},!1),o.addEventListener("load",function(i){e.funDeleteFile(t.index,!1),e.onSuccess(t,o.responseText),0==e.uploadFile.length&&e.onComplete("全部完成")},!1),o.addEventListener("error",function(i){e.onFailure(t,o.responseText)},!1),o.open("POST",e.url,!0),o.send(i)},funReturnNeedFiles:function(){return this.uploadFile},init:function(){var t=this;this.dragDrop&&(this.dragDrop.addEventListener("dragover",function(e){t.funDragHover(e)},!1),this.dragDrop.addEventListener("dragleave",function(e){t.funDragHover(e)},!1),this.dragDrop.addEventListener("drop",function(e){t.funGetFiles(e)},!1)),t.fileInput&&this.fileInput.addEventListener("change",function(e){t.funGetFiles(e)},!1),t.uploadInput&&this.uploadInput.addEventListener("click",function(e){t.funUploadFiles(e)},!1)}};!function(t,i){t.fn.zyUpload=function(i,n){var a=Array.prototype.slice.call(arguments,1);if("string"==typeof i){var s=this[0][i];if(t.isFunction(s))return s.apply(this,a);throw"zyUpload - No such method: "+i}return this.each(function(){var n={},a=this,s={width:"100%",height:"auto",itemWidth:"140px",itemHeight:"120px",url:"/upload/UploadAction",fileType:[],fileSize:512e5,multiple:!0,dragDrop:!0,tailor:!1,del:!0,finishDel:!1,onSelect:function(t,e){},onDelete:function(t,e){},onSuccess:function(t,e){},onFailure:function(t,e){},onComplete:function(t){}};n=t.extend(s,i),this.init=function(){this.createHtml(),this.createCorePlug()},this.createHtml=function(){var e="";e=n.multiple?"multiple":"";var i="";if(n.dragDrop)i+='<form id="uploadForm" action="'+n.url+'" method="post" enctype="multipart/form-data">',i+='\t<div class="upload_box">',i+='\t\t<div class="upload_main">',i+='\t\t\t<div class="upload_choose">',i+='\t\t\t\t<div class="convent_choice">',i+='\t\t\t\t\t<div class="andArea">',i+='\t\t\t\t\t\t<div class="filePicker">点击选择文件</div>',i+='\t\t\t\t\t\t<input id="fileImage" type="file" size="30" name="fileselect[]" '+e+">",i+="\t\t\t\t\t</div>",i+="\t\t\t\t</div>",i+='\t\t\t\t<span id="fileDragArea" class="upload_drag_area">或者将文件拖到此处</span>',i+="\t\t\t</div>",i+='\t\t\t<div class="status_bar">',i+='\t\t\t\t<div id="status_info" class="info">选中0张文件，共0B。</div>',i+='\t\t\t\t<div class="btns">',i+='\t\t\t\t\t<div class="webuploader_pick">继续选择</div>',i+='\t\t\t\t\t<div class="upload_btn">开始上传</div>',i+="\t\t\t\t</div>",i+="\t\t\t</div>",i+='\t\t\t<div id="preview" class="upload_preview"></div>',i+="\t\t</div>",i+='\t\t<div class="upload_submit">',i+='\t\t\t<button type="button" id="fileSubmit" class="upload_submit_btn">确认上传文件</button>',i+="\t\t</div>",i+='\t\t<div id="uploadInf" class="upload_inf"></div>',i+="\t</div>",i+="</form>";else{var o=parseInt(n.itemWidth.replace("px",""))-15;i+='<form id="uploadForm" action="'+n.url+'" method="post" enctype="multipart/form-data">',i+='\t<div class="upload_box">',i+='\t\t<div class="upload_main single_main">',i+='\t\t\t<div class="status_bar">',i+='\t\t\t\t<div id="status_info" class="info">选中0张文件，共0B。</div>',i+='\t\t\t\t<div class="btns">',i+='\t\t\t\t\t<input id="fileImage" type="file" size="30" name="fileselect[]" '+e+">",i+='\t\t\t\t\t<div class="webuploader_pick">选择文件</div>',i+='\t\t\t\t\t<div class="upload_btn">开始上传</div>',i+="\t\t\t\t</div>",i+="\t\t\t</div>",i+='\t\t\t<div id="preview" class="upload_preview">',i+='\t\t\t\t<div class="add_upload">',i+='\t\t\t\t\t<a style="height:'+n.itemHeight+";width:"+n.itemWidth+';" title="点击添加文件" id="rapidAddImg" class="add_imgBox" href="javascript:void(0)">',i+='\t\t\t\t\t\t<div class="uploadImg" style="width:'+o+'px">',i+='\t\t\t\t\t\t\t<img class="upload_image" src="zyupload/skins/images/add_img.png" style="width:expression(this.width > '+o+" ? "+o+'px : this.width)" />',i+="\t\t\t\t\t\t</div>",i+="\t\t\t\t\t</a>",i+="\t\t\t\t</div>",i+="\t\t\t</div>",i+="\t\t</div>",i+='\t\t<div class="upload_submit">',i+='\t\t\t<button type="button" id="fileSubmit" class="upload_submit_btn">确认上传文件</button>',i+="\t\t</div>",i+='\t\t<div id="uploadInf" class="upload_inf"></div>',i+="\t</div>",i+="</form>"}t(a).append(i).css({width:n.width,height:n.height}),this.addEvent()},this.funSetStatusInfo=function(e){var i=0,n=e.length;t.each(e,function(t,e){i+=e.size}),i=i>1048576?(Math.round(100*i/1048576)/100).toString()+"MB":(Math.round(100*i/1024)/100).toString()+"KB",t("#status_info").html("选中"+n+"张文件，共"+i+"。")},this.funFilterEligibleFile=function(t){for(var i,o=[],a=0;i=t[a];a++){var s=i.name.split("").reverse().join("");if(null!=s.split(".")[0]){var r=s.split(".")[0].split("").reverse().join("");e.inArray(r,n.fileType)>-1?i.size>=n.fileSize?alert('您这个"'+i.name+'"文件大小过大'):o.push(i):alert('您这个"'+i.name+'"上传类型不符合')}else alert('您这个"'+i.name+'"没有类型, 无法识别')}return o},this.funDisposePreviewHtml=function(t,e){var i="",o=parseInt(n.itemWidth.replace("px",""))-15,a=parseInt(n.itemHeight.replace("px",""))-10,s="",r="";n.tailor&&(s='<span class="file_edit" data-index="'+t.index+'" title="编辑"></span>'),n.del&&(r='<span class="file_del" data-index="'+t.index+'" title="删除"></span>');var l=t.name.split("").reverse().join(""),d=l.split(".")[0].split("").reverse().join(""),u="zyupload/skins/images/fileType/";return u+="rar"==d?"rar.png":"zip"==d?"zip.png":"txt"==d?"txt.png":"ppt"==d?"ppt.png":"xls"==d?"xls.png":"pdf"==d?"pdf.png":"psd"==d?"psd.png":"ttf"==d?"ttf.png":"swf"==d?"swf.png":"file.png",0==t.type.indexOf("image")?(i+='<div id="uploadList_'+t.index+'" class="upload_append_list">',i+='\t<div class="file_bar">',i+='\t\t<div style="padding:5px;">',i+='\t\t\t<p class="file_name" title="'+t.name+'">'+t.name+"</p>",i+=s,i+=r,i+="\t\t</div>",i+="\t</div>",i+='\t<a style="height:'+n.itemHeight+";width:"+n.itemWidth+';" href="#" class="imgBox">',i+='\t\t<div class="uploadImg" style="width:'+o+"px;max-width:"+o+"px;max-height:"+a+'px;">',i+='\t\t\t<img id="uploadImage_'+t.index+'" class="upload_image" src="'+e.target.result+'" style="width:expression(this.width > '+o+" ? "+o+'px : this.width);" />',i+="\t\t</div>",i+="\t</a>",i+='\t<p id="uploadProgress_'+t.index+'" class="file_progress"></p>',i+='\t<p id="uploadFailure_'+t.index+'" class="file_failure">上传失败，请重试</p>',i+='\t<p id="uploadTailor_'+t.index+'" class="file_tailor" tailor="false">裁剪完成</p>',i+='\t<p id="uploadSuccess_'+t.index+'" class="file_success"></p>',i+="</div>"):(i+='<div id="uploadList_'+t.index+'" class="upload_append_list">',i+='\t<div class="file_bar">',i+='\t\t<div style="padding:5px;">',i+='\t\t\t<p class="file_name">'+t.name+"</p>",i+=r,i+="\t\t</div>",i+="\t</div>",i+='\t<a style="height:'+n.itemHeight+";width:"+n.itemWidth+';" href="#" class="imgBox">',i+='\t\t<div class="uploadImg" style="width:'+o+'px">',i+='\t\t\t<img id="uploadImage_'+t.index+'" class="upload_file" src="'+u+'" style="width:expression(this.width > '+o+" ? "+o+'px : this.width)" />',i+="\t\t</div>",i+="\t</a>",i+='\t<p id="uploadProgress_'+t.index+'" class="file_progress"></p>',i+='\t<p id="uploadFailure_'+t.index+'" class="file_failure">上传失败，请重试</p>',i+='\t<p id="uploadSuccess_'+t.index+'" class="file_success"></p>',i+="</div>"),i},this.createPopupPlug=function(e,i,o){t("body").zyPopup({src:e,index:i,name:o,onTailor:function(e,o){var a=parseInt(n.itemWidth.replace("px","")),s=(parseInt(n.itemHeight.replace("px","")),e.width),r=e.height,l=a/s,d=l*o.width,u=l*o.height,c=e.leftX*l,p=e.rightY*l-r*l;t("#uploadImage_"+i).css({width:d,height:u,"margin-left":-c,"margin-top":-p}),t("#uploadTailor_"+i).show(),console.info(e);var f="{'leftX':"+e.leftX+",'leftY':"+e.leftY+",'rightX':"+e.rightX+",'rightY':"+e.rightY+",'width':"+e.width+",'height':"+e.height+"}";t("#uploadTailor_"+i).attr("tailor",f)}})},this.createCorePlug=function(){var e={fileInput:t("#fileImage").get(0),uploadInput:t("#fileSubmit").get(0),dragDrop:t("#fileDragArea").get(0),url:t("#uploadForm").attr("action"),filterFile:function(t){return a.funFilterEligibleFile(t)},onSelect:function(e,i){n.onSelect(e,i),a.funSetStatusInfo(o.funReturnNeedFiles());var s="",r=0,l=function(){if(file=e[r],file){var t=new FileReader;t.onload=function(t){s+=a.funDisposePreviewHtml(file,t),r++,l()},t.readAsDataURL(file)}else d(s)},d=function(e){n.dragDrop?t("#preview").append(e):t(".add_upload").before(e),u(),c()},u=function(){t(".file_del").length>0&&t(".file_del").click(function(){return o.funDeleteFile(parseInt(t(this).attr("data-index")),!0),!1}),t(".file_edit").length>0&&t(".file_edit").click(function(){var e=t(this).attr("data-index"),i=t(this).prev(".file_name").attr("title"),n=t("#uploadImage_"+e).attr("src");return a.createPopupPlug(n,e,i),!1})},c=function(){t(".upload_append_list").hover(function(e){t(this).find(".file_bar").addClass("file_hover")},function(e){t(this).find(".file_bar").removeClass("file_hover")})};l()},onDelete:function(e,i){n.onDelete(e,i),t("#uploadList_"+e.index).fadeOut(),a.funSetStatusInfo(i),console.info("剩下的文件"),console.info(i)},onProgress:function(e,i,n){var o=t("#uploadProgress_"+e.index),a=(i/n*100).toFixed(2)+"%";o.is(":hidden")&&o.show(),o.css("width",a)},onSuccess:function(e,i){n.onSuccess(e,i),t("#uploadProgress_"+e.index).hide(),t("#uploadSuccess_"+e.index).show(),n.finishDel&&(t("#uploadList_"+e.index).fadeOut(),a.funSetStatusInfo(o.funReturnNeedFiles())),t("#uploadTailor_"+e.index).length>0&&t("#uploadTailor_"+e.index).hide()},onFailure:function(e,i){n.onFailure(e,i),t("#uploadProgress_"+e.index).hide(),t("#uploadSuccess_"+e.index).show(),t("#uploadTailor_"+e.index).length>0&&t("#uploadTailor_"+e.index).hide(),t("#uploadInf").append("<p>文件"+e.name+"上传失败！</p>")},onComplete:function(t){n.onComplete(t),console.info(t)},onDragOver:function(){t(this).addClass("upload_drag_hover")},onDragLeave:function(){t(this).removeClass("upload_drag_hover")}};o=t.extend(o,e),o.init()},this.addEvent=function(){t(".filePicker").length>0&&t(".filePicker").bind("click",function(e){t("#fileImage").click()}),t(".webuploader_pick").bind("click",function(e){t("#fileImage").click()}),t(".upload_btn").bind("click",function(e){o.funReturnNeedFiles().length>0?t("#fileSubmit").click():alert("请先选中文件再点击上传")}),t("#rapidAddImg").length>0&&t("#rapidAddImg").bind("click",function(e){t("#fileImage").click()})},this.init()})}}(e),t("zyupload")}).addcss("../../css/zyupload.css","zyuploadcss");